<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Service Area - Agency Panel</title>
    <link rel="stylesheet" href="../styles/admin.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-building"></i>
                    <span>Agency Panel</span>
                </div>
                <button class="sidebar-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <nav class="sidebar-nav">
                <ul>
                    <li class="nav-item">
                        <a href="dashboard.html">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="requests.html">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Requests</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="field-officers.html">
                            <i class="fas fa-users"></i>
                            <span>Field Officers</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="quality-control.html">
                            <i class="fas fa-shield-alt"></i>
                            <span>Quality Control</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="tracking.html">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Live Tracking</span>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a href="service-areas.html">
                            <i class="fas fa-map"></i>
                            <span>Service Areas</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="gate-passes.html">
                            <i class="fas fa-id-card"></i>
                            <span>Gate Passes</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="agreements.html">
                            <i class="fas fa-file-contract"></i>
                            <span>Agreements</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="reports.html">
                            <i class="fas fa-chart-bar"></i>
                            <span>Reports</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="settings.html">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <div class="breadcrumb">
                        <a href="service-areas.html" class="breadcrumb-link">
                            <i class="fas fa-arrow-left"></i>
                            Back to Service Areas
                        </a>
                    </div>
                    <h1>Edit Service Area</h1>
                    <p>Update service area information and coverage details</p>
                </div>
                <div class="header-right">
                    <div class="notifications">
                        <i class="fas fa-bell"></i>
                        <span class="badge">5</span>
                    </div>
                    <div class="user-menu">
                        <img src="https://via.placeholder.com/40" alt="Agency" class="user-avatar">
                        <div class="user-info">
                            <span class="user-name">ABC Agency</span>
                            <span class="user-role">Valuation Agency</span>
                        </div>
                        <button class="logout-btn" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <div class="page-content">
                <div class="form-container">
                    <div class="form-header">
                        <h2 id="formTitle">Edit Service Area - Mumbai Central</h2>
                        <p>Update the service area information and coverage details</p>
                    </div>

                    <form class="modern-form" id="editServiceAreaForm">
                        <!-- Basic Information Section -->
                        <div class="form-section">
                            <div class="section-title">
                                <i class="fas fa-info-circle"></i>
                                <h3>Basic Information</h3>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Area Name</label>
                                    <input type="text" id="areaName" required>
                                </div>
                                <div class="form-group">
                                    <label>Area Code</label>
                                    <input type="text" id="areaCode" readonly>
                                    <small>Area code cannot be changed</small>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>City</label>
                                    <input type="text" id="areaCity" required>
                                </div>
                                <div class="form-group">
                                    <label>State</label>
                                    <select id="areaState" required>
                                        <option value="maharashtra">Maharashtra</option>
                                        <option value="delhi">Delhi</option>
                                        <option value="karnataka">Karnataka</option>
                                        <option value="tamil-nadu">Tamil Nadu</option>
                                        <option value="gujarat">Gujarat</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Start Pincode</label>
                                    <input type="text" id="startPincode" required>
                                </div>
                                <div class="form-group">
                                    <label>End Pincode</label>
                                    <input type="text" id="endPincode" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Status</label>
                                    <select id="areaStatus" required>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                        <option value="pending">Pending</option>
                                        <option value="suspended">Suspended</option>
                                        <option value="maintenance">Under Maintenance</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Area Type</label>
                                    <select id="areaType" required>
                                        <option value="urban">Urban</option>
                                        <option value="suburban">Suburban</option>
                                        <option value="rural">Rural</option>
                                        <option value="mixed">Mixed</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Coverage Details Section -->
                        <div class="form-section">
                            <div class="section-title">
                                <i class="fas fa-map"></i>
                                <h3>Coverage Details</h3>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Coverage Area (sq km)</label>
                                    <input type="number" id="coverageArea" min="0" step="0.1" required>
                                </div>
                                <div class="form-group">
                                    <label>Population</label>
                                    <input type="text" id="population" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Service Hours Start</label>
                                    <input type="time" id="serviceStart" required>
                                </div>
                                <div class="form-group">
                                    <label>Service Hours End</label>
                                    <input type="time" id="serviceEnd" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Working Days</label>
                                    <select id="workingDays" required>
                                        <option value="7-days">7 Days a Week</option>
                                        <option value="6-days">6 Days a Week</option>
                                        <option value="5-days">5 Days a Week</option>
                                        <option value="custom">Custom</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Response Time (minutes)</label>
                                    <input type="number" id="responseTime" min="0" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Major Landmarks</label>
                                <textarea id="landmarks" rows="3" required></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label>Business Districts</label>
                                <textarea id="businessDistricts" rows="3" required></textarea>
                            </div>
                        </div>

                        <!-- Field Officers Assignment Section -->
                        <div class="form-section">
                            <div class="section-title">
                                <i class="fas fa-users"></i>
                                <h3>Field Officers Assignment</h3>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Total Officers Required</label>
                                    <input type="number" id="totalOfficers" min="1" required>
                                </div>
                                <div class="form-group">
                                    <label>Currently Assigned</label>
                                    <input type="number" id="assignedOfficers" min="0" readonly>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Assigned Field Officers</label>
                                <div class="officer-list" id="officerList">
                                    <!-- Officers will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>

                        <!-- Pricing & Service Details Section -->
                        <div class="form-section">
                            <div class="section-title">
                                <i class="fas fa-dollar-sign"></i>
                                <h3>Pricing & Service Details</h3>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Base Service Charge (₹)</label>
                                    <input type="number" id="baseCharge" min="0" required>
                                </div>
                                <div class="form-group">
                                    <label>Additional Charges (₹)</label>
                                    <input type="number" id="additionalCharge" min="0" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Priority Service Charge (₹)</label>
                                    <input type="number" id="priorityCharge" min="0" required>
                                </div>
                                <div class="form-group">
                                    <label>Emergency Service Charge (₹)</label>
                                    <input type="number" id="emergencyCharge" min="0" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Service Description</label>
                                <textarea id="serviceDescription" rows="3" required></textarea>
                            </div>
                        </div>

                        <!-- Document Upload Section -->
                        <div class="form-section">
                            <div class="section-title">
                                <i class="fas fa-file-upload"></i>
                                <h3>Area Documents</h3>
                            </div>
                            
                            <div class="upload-section">
                                <div class="upload-area">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <h3>Upload Area Documents</h3>
                                    <p>Drag and drop files here or click to browse</p>
                                    <input type="file" multiple accept=".pdf,.jpg,.jpeg,.png,.doc,.docx,.kml,.kmz">
                                </div>
                                
                                <div class="template-download">
                                    <h4>Document Templates</h4>
                                    <p>Download area management templates</p>
                                    <div class="template-links">
                                        <a href="#" class="btn btn-outline btn-sm">
                                            <i class="fas fa-download"></i>
                                            Area Coverage Template
                                        </a>
                                        <a href="#" class="btn btn-outline btn-sm">
                                            <i class="fas fa-download"></i>
                                            Service Agreement Template
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn btn-outline" onclick="cancelEdit()">
                                <i class="fas fa-times"></i>
                                Cancel
                            </button>
                            <button type="button" class="btn btn-outline" onclick="viewServiceArea()">
                                <i class="fas fa-eye"></i>
                                View Details
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i>
                                Save Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/agency.js"></script>
    <script>
        // Get area ID from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const areaId = urlParams.get('id') || 'AR001';
        
        // Area data mapping
        const areaData = {
            'AR001': {
                name: 'Mumbai Central',
                code: 'AR001',
                city: 'Mumbai',
                state: 'maharashtra',
                startPincode: '400001',
                endPincode: '400099',
                status: 'active',
                areaType: 'urban',
                coverageArea: 45.2,
                population: '2.5 Lakhs',
                serviceStart: '08:00',
                serviceEnd: '20:00',
                workingDays: '7-days',
                responseTime: 15,
                landmarks: 'Mumbai Central Station, Crawford Market, Marine Drive, Gateway of India, CST Station',
                businessDistricts: 'Fort, Nariman Point, Colaba, Ballard Estate, Churchgate',
                totalOfficers: 8,
                assignedOfficers: 8,
                baseCharge: 1500,
                additionalCharge: 200,
                priorityCharge: 500,
                emergencyCharge: 1000,
                serviceDescription: 'Comprehensive vehicle valuation services including physical inspection, photo documentation, and detailed reporting for the Mumbai Central area.',
                assignedOfficersList: ['FO001', 'FO002', 'FO003', 'FO004', 'FO005', 'FO006', 'FO007', 'FO008']
            },
            'AR002': {
                name: 'Pune Station',
                code: 'AR002',
                city: 'Pune',
                state: 'maharashtra',
                startPincode: '411001',
                endPincode: '411099',
                status: 'active',
                areaType: 'urban',
                coverageArea: 38.5,
                population: '1.8 Lakhs',
                serviceStart: '08:00',
                serviceEnd: '20:00',
                workingDays: '7-days',
                responseTime: 18,
                landmarks: 'Pune Station, FC Road, Koregaon Park, Aundh, Baner',
                businessDistricts: 'Camp, Deccan, Kalyani Nagar, Viman Nagar, Hinjewadi',
                totalOfficers: 6,
                assignedOfficers: 1,
                baseCharge: 1200,
                additionalCharge: 150,
                priorityCharge: 400,
                emergencyCharge: 800,
                serviceDescription: 'Professional vehicle valuation and inspection services for the Pune Station area with quick turnaround times.',
                assignedOfficersList: ['FO003']
            },
            'AR003': {
                name: 'Nagpur City',
                code: 'AR003',
                city: 'Nagpur',
                state: 'maharashtra',
                startPincode: '440001',
                endPincode: '440099',
                status: 'pending',
                areaType: 'urban',
                coverageArea: 42.1,
                population: '2.1 Lakhs',
                serviceStart: '08:00',
                serviceEnd: '20:00',
                workingDays: '7-days',
                responseTime: 20,
                landmarks: 'Nagpur Station, Seminary Hills, Dragon Palace, Zero Mile, Futala Lake',
                businessDistricts: 'Sitabuldi, Dharampeth, Civil Lines, Wardha Road, Kamptee Road',
                totalOfficers: 5,
                assignedOfficers: 0,
                baseCharge: 1000,
                additionalCharge: 120,
                priorityCharge: 300,
                emergencyCharge: 600,
                serviceDescription: 'Reliable vehicle valuation services for the Nagpur City area with comprehensive coverage and detailed reporting.',
                assignedOfficersList: []
            }
        };
        
        // Officers data for assignment
        const officersData = [
            { id: 'FO001', name: 'John Smith', assigned: true },
            { id: 'FO002', name: 'Sarah Jones', assigned: true },
            { id: 'FO003', name: 'Mike Wilson', assigned: true },
            { id: 'FO004', name: 'Lisa Brown', assigned: true },
            { id: 'FO005', name: 'David Lee', assigned: true },
            { id: 'FO006', name: 'Emma Davis', assigned: true },
            { id: 'FO007', name: 'James Wilson', assigned: true },
            { id: 'FO008', name: 'Maria Garcia', assigned: true }
        ];
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadAreaData();
            renderOfficersList();
        });
        
        function loadAreaData() {
            const data = areaData[areaId];
            if (data) {
                // Update form title
                document.getElementById('formTitle').textContent = `Edit Service Area - ${data.name}`;
                
                // Populate form fields
                document.getElementById('areaName').value = data.name;
                document.getElementById('areaCode').value = data.code;
                document.getElementById('areaCity').value = data.city;
                document.getElementById('areaState').value = data.state;
                document.getElementById('startPincode').value = data.startPincode;
                document.getElementById('endPincode').value = data.endPincode;
                document.getElementById('areaStatus').value = data.status;
                document.getElementById('areaType').value = data.areaType;
                document.getElementById('coverageArea').value = data.coverageArea;
                document.getElementById('population').value = data.population;
                document.getElementById('serviceStart').value = data.serviceStart;
                document.getElementById('serviceEnd').value = data.serviceEnd;
                document.getElementById('workingDays').value = data.workingDays;
                document.getElementById('responseTime').value = data.responseTime;
                document.getElementById('landmarks').value = data.landmarks;
                document.getElementById('businessDistricts').value = data.businessDistricts;
                document.getElementById('totalOfficers').value = data.totalOfficers;
                document.getElementById('assignedOfficers').value = data.assignedOfficers;
                document.getElementById('baseCharge').value = data.baseCharge;
                document.getElementById('additionalCharge').value = data.additionalCharge;
                document.getElementById('priorityCharge').value = data.priorityCharge;
                document.getElementById('emergencyCharge').value = data.emergencyCharge;
                document.getElementById('serviceDescription').value = data.serviceDescription;
            }
        }
        
        function renderOfficersList() {
            const data = areaData[areaId];
            const officerList = document.getElementById('officerList');
            officerList.innerHTML = '';
            
            officersData.forEach(officer => {
                const isAssigned = data.assignedOfficersList.includes(officer.id);
                const officerElement = document.createElement('div');
                officerElement.className = 'officer-item';
                officerElement.innerHTML = `
                    <input type="checkbox" id="${officer.id}" ${isAssigned ? 'checked' : ''}>
                    <label for="${officer.id}">${officer.name} (${officer.id})</label>
                `;
                officerList.appendChild(officerElement);
            });
        }
        
        // Form submission handler
        document.getElementById('editServiceAreaForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Collect form data
            const formData = {
                name: document.getElementById('areaName').value,
                code: document.getElementById('areaCode').value,
                city: document.getElementById('areaCity').value,
                state: document.getElementById('areaState').value,
                startPincode: document.getElementById('startPincode').value,
                endPincode: document.getElementById('endPincode').value,
                status: document.getElementById('areaStatus').value,
                areaType: document.getElementById('areaType').value,
                coverageArea: document.getElementById('coverageArea').value,
                population: document.getElementById('population').value,
                serviceStart: document.getElementById('serviceStart').value,
                serviceEnd: document.getElementById('serviceEnd').value,
                workingDays: document.getElementById('workingDays').value,
                responseTime: document.getElementById('responseTime').value,
                landmarks: document.getElementById('landmarks').value,
                businessDistricts: document.getElementById('businessDistricts').value,
                totalOfficers: document.getElementById('totalOfficers').value,
                baseCharge: document.getElementById('baseCharge').value,
                additionalCharge: document.getElementById('additionalCharge').value,
                priorityCharge: document.getElementById('priorityCharge').value,
                emergencyCharge: document.getElementById('emergencyCharge').value,
                serviceDescription: document.getElementById('serviceDescription').value
            };
            
            // Update area data
            areaData[areaId] = { ...areaData[areaId], ...formData };
            
            showNotification('Service area updated successfully!', 'success');
            setTimeout(() => {
                window.location.href = 'service-areas.html';
            }, 2000);
        });

        function cancelEdit() {
            if (confirm('Are you sure you want to cancel? All changes will be lost.')) {
                window.location.href = 'service-areas.html';
            }
        }

        function viewServiceArea() {
            window.location.href = `view-service-area.html?id=${areaId}`;
        }

        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                    <span>${message}</span>
                </div>
                <button class="notification-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 5000);
        }
    </script>
</body>
</html> 